import"core-js/modules/es.array.concat.js";import"core-js/modules/es.array.join.js";import"core-js/modules/es.array.index-of.js";import"core-js/modules/es.array.from.js";import"core-js/modules/es.string.iterator.js";import React from"react";import*as d3 from"d3";import{RemoveChart}from"../../components/chart";import{getElementHeight,getElementWidth}from"../../utils/dom";import{createSVG}from"../../components/svg";import{createTitle}from"../../components/text";import{createXAxis,createYAxis}from"../../components/axis";import PropTypes from"prop-types";import{createLegend}from"../../components/legend";import{createTooltip}from"../../components/tooltip";export default function ScatterChart(props){var svgRef=React.useRef(null),handleLoad=function(){RemoveChart(svgRef),createScatterChart(svgRef,props)};return React.useEffect(function(){handleLoad()},[props]),React.createElement("svg",{width:"100%",ref:svgRef})}function createScatterChart(element,props){var data=props.data,mapper=props.mapper,base=props.base,margin=props.margin,xAxis=props.xAxis,yAxis=props.yAxis,node=props.node,tooltip=props.tooltip,animation=props.animation,legend=props.legend,font=props.font;if(0!=data.length){void 0===base.width&&(base.width=getElementWidth(element)),void 0===base.height&&(base.height=getElementHeight(element)),xAxis.range=[margin.left,base.width-margin.right],yAxis.range=[base.height-margin.bottom,margin.top],xAxis.type=d3.scaleLinear,yAxis.type=d3.scaleLinear,void 0===font.size&&(font.size=Math.min(base.width,base.height)/25+"px"),void 0===node.color&&(base.color=d3.schemeAccent);var x=d3.map(data,mapper.getX),y=d3.map(data,mapper.getY),I=d3.range(x.length),group=d3.map(data,mapper.getGroup),distinctGroup=new d3.InternSet(group);void 0===xAxis.domain&&(xAxis.domain=[.9*d3.min(x),1.1*d3.max(x)]),void 0===yAxis.domain&&(yAxis.domain=[.9*d3.min(y),1.1*d3.max(y)]);var xScale=d3.scaleLinear(xAxis.domain,xAxis.range),yScale=d3.scaleLinear(yAxis.domain,yAxis.range),colorScale=d3.scaleOrdinal(group,base.color);void 0===tooltip.mapper&&(tooltip.mapper=function(i){return"Group : ".concat(group[i],"\nx : ").concat(x[i],"\ny : ").concat(y[i])});var svg=createSVG(element,base.width,base.height);if(createTitle(svg,props),xAxis.enabled&&createXAxis(svg,d3.axisBottom(xScale).tickSizeOuter(0),props,!0),yAxis.enabled){var yAxisGenerator=d3.axisLeft(yScale).ticks(base.height/40).tickSizeOuter(0);createYAxis(svg,yAxisGenerator,props)}var dots=svg.append("g");dots.selectAll("circle").data(I).join("circle").attr("class",function(i){return"dot dot_"+Array.from(distinctGroup).indexOf(group[i])}).attr("stroke",function(i){return colorScale(group[i])}).attr("stroke-width","1px").attr("fill",function(i){return colorScale(group[i])}).attr("fill-opacity",.4).attr("cx",function(i){return xScale(x[i])}).attr("cy",function(i){return yScale(y[i])}).attr("r",node.radius),animation.enabled&&dots.selectAll("circle").data(I).attr("r",0).transition().attr("r",node.radius).duration(animation.duration).ease(d3.easeExpInOut);var onHover=function(_,i){dots.selectAll(".dot").style("opacity",.1),dots.selectAll(".dot_"+i).style("opacity",1)},noHover=function(){dots.selectAll(".dot").style("opacity",1)};if(legend.enabled&&createLegend(svg,Array.from(distinctGroup),colorScale,props,onHover,noHover),tooltip.enabled){var _createTooltip=createTooltip(svg,props),showTooltip=_createTooltip.showTooltip,moveTooltip=_createTooltip.moveTooltip,hideTooltip=_createTooltip.hideTooltip;dots.selectAll(".dot").on("mouseover",showTooltip).on("mousemove",moveTooltip).on("mouseleave",hideTooltip)}}}ScatterChart.propTypes={data:PropTypes.arrayOf(PropTypes.object).isRequired,map:PropTypes.objectOf(PropTypes.any),base:PropTypes.objectOf(PropTypes.any),margin:PropTypes.objectOf(PropTypes.number),xAxis:PropTypes.objectOf(PropTypes.any),yAxis:PropTypes.objectOf(PropTypes.any),tooltip:PropTypes.objectOf(PropTypes.any),animation:PropTypes.objectOf(PropTypes.any),legend:PropTypes.objectOf(PropTypes.any),font:PropTypes.objectOf(PropTypes.any),node:PropTypes.objectOf(PropTypes.any)},ScatterChart.defaultProps={mapper:{getX:function getX(d){return d.x},getY:function getY(d){return d.y},getGroup:function getGroup(d){return d.group}},base:{width:void 0,height:300,title:"ScatterChart",color:void 0},tooltip:{mapper:void 0,enabled:!0},xAxis:{title:"x",type:d3.scaleTime,domain:void 0,range:void 0,padding:0,tickRotation:void 0,tickOffset:void 0,enabled:!0},yAxis:{title:"y",type:d3.scaleLinear,domain:void 0,range:void 0,enabled:!0},zAxis:{domain:void 0,range:void 0,zMax:30},margin:{top:40,right:100,bottom:60,left:60},animation:{duration:1e3,enabled:!0},legend:{enabled:!0},node:{radius:5,color:void 0},font:{size:"12px"}};